
var week=["Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"];var task=[["crossingmajorhighways","Crossing major highways"],["crossingminorhighways","Crossing minor highways"],["islandsmajorhighways","Islands major highways"],["islandsminorhighways","Islands minor highways"],["impossibleangle","Kinks major highways"],["kinksminorhighways","Kinks minor highways"],["overlappingmajorhighways","Overlapping major highways"],["overlappingminorhighways","Overlapping minor highways"],["highwayfootpath","Highway intersects footpath"],["highwayintersectswatermajor","Highway intersects water - major"],["highwayriverbank","Highway intersects water - minor"]];var users=[["Rub21","Ruben"],["RichRico","Richman"],["ridixcr","Pavel"],["ediyes","Edith"],["Luis36995","Luis"],["samely","Sammy"],["karitotp","Karito"],["calfarome","Cesar"],["dannykath","Danny"],["yurasi","Galia"],["piligab","Pilar"]];$(function(){$("#datepicker").datepicker({isRTL:false,format:"yyyy/mm/dd",autoclose:true,language:"en"}).on("changeDate",function(a){if(a.date.valueOf()!==null){$(this).datepicker("hide");var b=new Date($(this).val());$("#fecha").html(week[b.getDay()]);generateReport(customFormatDate(b))}})});function generateReport(a){var b="<tr>\n";b+="<th></th>\n";for(i=0;i<users.length;i++){b+="<th>"+users[i][1]+"</th>\n"}b+="<th>Total</th>\n";b+="</tr>";$("#titulos").html(b);var b="";for(i=0;i<task.length;i++){b+='<tr id="r'+i+'"><td style="font-weight: bold;">'+task[i][1]+"</td>\n";for(j=0;j<users.length;j++){b+='<td id="ref'+i+""+j+'">0</td>\n'}b+='<td id="t'+i+'" style="font-weight: bold;color:blue;">0</td>\n';b+="</tr>"}$("#items").html(b);for(i=0;i<task.length;i++){for(j=0;j<users.length;j++){stats_user(task[i][0],users[j][0],a,"ref"+i+""+j,i)}}setTimeout(function(){var c=0;for(i=0;i<task.length;i++){c=0;$("#r"+i+" > td").each(function(d){if(d>0&&d<8){c+=parseFloat($(this).text())}});$("#t"+i).html(c)}},100)}function stats_user(e,a,c,b,d){$.ajax({url:"https://to-fix-backend.mapbox.com/track_stats/"+e+"/from:"+c+"/to:"+c+"?"+new Date().getTime(),method:"GET",dataType:"json",timeout:2000,data:{},success:function(m){var o,l,p,h,k=0;var g=buscarUsuario(m.stats,a);if(g>-1){o=esDefinido(m.stats[g].edit);l=esDefinido(m.stats[g].fix);p=esDefinido(m.stats[g].noterror);h=esDefinido(m.stats[g].skip);k=o+l+p+h}else{k=0}$("#"+b).html(k)}})}function esDefinido(a){return a===undefined||a===null?0:a}function buscarUsuario(a,c){var b=-1;for(is=0;is<a.length;is++){if(a[is].user.startsWith(c)){b=is;break}}return b}function out(a){console.log(a)}function customFormatDate(a){return a.getFullYear()+"-"+customFormatNumber(a.getMonth()+1)+"-"+customFormatNumber(a.getDate())}function customFormatNumber(a){return a>=10?(""+a):("0"+a)};